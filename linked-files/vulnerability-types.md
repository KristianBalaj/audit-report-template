<!-- Use the tags to link vulnerability types -->

# Vulnerability types

The following list of vulnerability types represents a list of commonly found vulnerabilities in Cardano smart contract protocol designs or implementations. The list of types is actively updated and added to as new vulnerabilities are found.

<a name="other-redeemer"></a>

## Other redeemer

**ID:** other-redeemer

**Test:** Transaction can avoid some checks when it can successfully spend a UTxO or mint a token with a redeemer that some script logic didn’t expect to be used.

**Property:** A validator/policy should check explicitly whether the ‘other’ validator/policy is invoked with the expected redeemer.

**Impacts:**

- Bypassing checks

<a name="other-token-names"></a>

## Other token name

**ID:** other-token-names

**Test:** Transaction can mint additional tokens with some ‘other’ token name of ‘own’ currency alongside the intended token name.

**Property:** A policy should check that the total value minted of their ‘own’ currency symbol doesn’t include unintended token names.

**Impacts:**

- Stealing protocol tokens
- Unauthorised protocol actions

**Example:**

A common coding pattern that introduces such a vulnerability can be observed in the following excerpt:

```haskell
vulnPolicy rmr ctx = do
  …
  assetClassValueOf txInfoMint ownAssetClass == someQuantity
  …
```

The recommended coding pattern to use in order to prevent such a vulnerability can be observed in the following excerpt:

```haskell
safePolicy rmr ctx = do
  …
  txInfoMint == (assetClassValue ownAssetClass someQuantity)
  …
```

<a name="unbounded-protocol-datum"></a>

## Unbounded Protocol datum

**ID:** unbounded-protocol-datum

**Test:** Transaction can create protocol UTxOs with increasingly bigger protocol datums.

**Property:** A protocol should ensure that all protocol datums are bounded within reasonable limits.

**Impacts:**

- Script XU and/or size overflow
- Unspendable outputs
- Protocol halting

**Example:**

A common design pattern that introduces such vulnerability can be observed in the following excerpt:

```haskell
data MyDatum = Foo {
  users :: [String],
  userToPkh :: Map String PubKeyHash
}
```

If the protocol allows these datums to grow indefinitely, eventually XU and/or size limits imposed by the Plutus interpreter will be reached, rendering the output unspendable.

The recommended design patterns is either to limit the growth of such datums in validators/policies or to split the datum across different outputs.

<a name="arbitrary-utxo-datum"></a>

## Arbitrary UTxO datum

**ID:** arbitrary-utxo-datum

**Test:** Transaction can create protocol UTxOs with arbitrary datums.

**Property:** A protocol should ensure that all protocol UTxOs hold intended datums.

**Impacts:**

- Script XU overflow
- Unspendable outputs
- Protocol halting

<a name="unbounded-protocol-value"></a>

## Unbounded protocol value

**ID:** unbounded-protocol-value

**Test:** Transaction can create increasingly more protocol tokens in protocol UTxOs.

**Property:** A protocol should ensure that protocol values held in protocol UTxOs are bounded within reasonable limits.

**Impacts:**

- Script XU overflow
- Unspendable outputs
- Protocol halting

<a name="foreign-utxo-tokens"></a>

## Foreign UTxO tokens

**ID:** foreign-utxo-tokens

**Test:** Transaction can create protocol UTxOs with foreign tokens attached alongside the protocol tokens.

**Property:** A protocol should ensure that protocol UTxOs only hold the tokens used by the protocol.

**Impacts:**

- Script XU overflow
- Unspendable outputs
- Protocol halting

<a name="multiple-satisfaction"></a>

## Multiple satisfaction

**ID:** multiple-satisfaction

**Test:** Transaction can spend multiple UTxOs from a validator by satisfying burning and/or paying requirements for a single input while paying the rest of the unaccounted input value to a foreign address.

**Property:** A validator/policy should ensure that all burning and paying requirements consider all relevant inputs in aggregate.

**Impacts:**

- Stealing protocol tokens
- Unauthorised protocol actions
- Integrity

**Example:**

A common coding pattern that introduces such a vulnerability can be observed in the following excerpt:

```haskell
vulnValidator _ _ ctx =
  ownInput ← findOwnInput ctx
  ownOutput ← findContinuingOutput ctx
  traceIfFalse “Must continue tokens” (valueIn ownInput == valueIn ownOutput)
```

Imagine two outputs at `vulnValidator` holding the same values

A. `TxOut ($FOO x 1 + $ADA x 2)` B. `TxOut ($FOO x 1 + $ADA x 2)`

A transaction that spends both of these outputs can steal value from one spent output by simply paying `$FOO x 1 + $ADA x 2` to the ‘correct’ address of the `vulnValidator`, and paying the rest `$FOO x 1 + $ADA x 2` to an arbitrary address.

<a name="locked-ada"></a>

## Locked Ada

**ID:** locked-ada

**Test:** Protocol locks Ada value indefinitely in obsolete validator outputs.

**Property:** Protocol should include mechanisms to enable redeeming any Ada value stored at obsolete validator outputs.

**Impacts:**

- Financial sustainability
- Cardano halting

<a name="locked-nonada-values"></a>

## Locked non Ada values

**ID:** locked-nonada-values

**Test:** Protocol indefinitely locks some non-Ada values that ought to be circulating in the economy.

**Property:** Protocol should include mechanisms to enable redeeming any non-Ada value stored at obsolete validator outputs.

**Impacts:**

- Financial sustainability
- Protocol halting

<a name="missing-utxo-authentication"></a>

## Missing UTxO authentication

**ID:** missing-utxo-authentication

**Test:** Transaction can perform a protocol action by spending or referencing an illegitimate output of a protocol validator.

**Property:** All spending and referencing of protocol outputs should be authenticated.

**Impacts:**

- Unauthorised protocol actions

**Example:**

Checking only for validator address and not checking for an authentication token.,

<a name="missing-incentive"></a>

## Missing incentive

**ID:** missing-incentive

**Test:** There is no incentive for users to participate in the protocol to maintain the intended goals of the protocol.

**Property:** All users in the Protocol should have an incentive to maintain the intended goals of the protocol

**Impacts:**

- Protocol stalling
- Protocol halting

<a name="bad-incentive"></a>

## Bad incentive

**ID:** bad-incentive

**Test:** There is an incentive for users to participate in the protocol that compromises the intended goals of the protocol.

**Property:** No users of the protocol should have an incentive to compromise the intended goals of the protocol.

**Impacts:**

- Protocol stalling
- Protocol halting

<a name="utxo-contention"></a>

## UTxO contention

**ID:** utxo-contention

**Test:** The protocol requires that transactions spend a globally shared UTxO(s) thereby introducing a contention point.

**Property:** The protocol should enable parallel transactions and contention-less global state management if possible.

**Impacts:**

- Protocol stalling
- Protocol halting

<a name="cheap-spam"></a>

## Cheap spam

**ID:** cheap-spam

**Test:** A transaction can introduce an idempotent or useless action/effect in the protocol for a low cost that can compromise protocol operations.

**Property:** The protocol should ensure that the cost for introducing a salient action is sufficient to deter spamming.

Severity increases when compounded with the `utxo-contention` vulnerability.

**Impacts:**

- Protocol stalling
- Protocol halting

<a name="insufficient-tests"></a>

## Insufficient tests

**ID:** insufficient-tests

**Test:** There is piece of validation logic that tests do not attempt to verify.

**Property:** Every piece of validator code gets meaningfully executed during tests.

**Impacts:**

- Correctness

<a name="incorrect-documentation"></a>

## Incorrect documentation

**ID:** incorrect-documentation

**Test:** There is a mistake or something confusing in existing documentation.

**Property:** Everything documented is clear and correct.

**Impacts:**

- Correctness
- Maintainability

<a name="insufficient-documentation"></a>

## Insufficient documentation

**ID:** insufficient-documentation

**Test:** There is a lack of important documentation.

**Property:** Everything of importance is documented.

**Impacts:**

- Comprehension
- Correctness

<a name="poor-code-standards"></a>

## Poor Code Standards

**ID:** poor-code-standards

**Test:** Missing the use of code quality and stadardisation tools. 

**Property:** Code is properly formatted, linted, and uses an adequate code standard.

**Impacts:**

- Codebase Maintainability 
- Comprehension
